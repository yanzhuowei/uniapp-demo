{"version":3,"sources":["uni-app:///main.js","webpack:///D:/源码/cloubmyuniapp/pages/auth/auth.vue?aa0d","webpack:///D:/源码/cloubmyuniapp/pages/auth/auth.vue?b485","webpack:///D:/源码/cloubmyuniapp/pages/auth/auth.vue?acd8","webpack:///D:/源码/cloubmyuniapp/pages/auth/auth.vue?ac93","uni-app:///pages/auth/auth.vue","webpack:///D:/源码/cloubmyuniapp/pages/auth/auth.vue?7f67","webpack:///D:/源码/cloubmyuniapp/pages/auth/auth.vue?319b"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,yF;AACAA,UAAU,CAACC,aAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiH;AACjH;AACwD;AACL;AACa;;;AAGhE;AACiM;AACjM,gBAAgB,2MAAU;AAC1B,EAAE,0EAAM;AACR,EAAE,+EAAM;AACR,EAAE,wFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,mFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAuvB,CAAgB,owBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;ACO3wB;AACA;AACA;AACA,4F;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,eADA,uBACA,EADA,EACA;AACA;AACA;AACA;;AAEA;AALA;;;;;AAWA,eAXA,CAOA,aAPA,cAOA,aAPA,CAQA,EARA,cAQA,EARA,CASA,OATA,cASA,OATA,CAUA,SAVA,cAUA,SAVA;;AAaA;AACA;AACA,KAhBA;;AAkBA,QAlBA,gBAkBA,aAlBA,EAkBA,EAlBA,EAkBA,OAlBA,EAkBA,SAlBA,EAkBA;;;;;AAKA,uCALA,sCAIA,IAJA,gBAIA,IAJA;;;;AASA;AACA,uDADA;AAEA,kCAFA;AAGA;AACA,gCADA;AAEA,kDAFA;AAGA,4BAHA;AAIA,sCAJA;AAKA,0CALA,EAHA,GATA,SASA,IATA;;;;AAqBA;AACA;AACA;AACA;;AAEA;AACA;AACA,0BADA;;;AAIA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AArDA,2EAsDA,CAxEA,EAPA;;;AAkFA,QAlFA,oBAkFA;;;;;AAKA,0CALA,4CAIA,WAJA,qBAIA,WAJA;;AAOA,2CAPA;;;;;;;AAcA,2CAdA,6CAUA,aAVA,sBAUA,aAVA,CAWA,EAXA,sBAWA,EAXA,CAYA,OAZA,sBAYA,OAZA,CAaA,SAbA,sBAaA,SAbA;;AAgBA;AACA,gEAjBA;;;;;;;;;;;;;;;;;;AAmCA,GArHA,E;;;;;;;;;;;;;ACZA;AAAA;AAAA;AAAA;AAAskC,CAAgB,qjCAAG,EAAC,C;;;;;;;;;;;ACA1lC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/auth/auth.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/auth/auth.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./auth.vue?vue&type=template&id=7ea503f4&\"\nvar renderjs\nimport script from \"./auth.vue?vue&type=script&lang=js&\"\nexport * from \"./auth.vue?vue&type=script&lang=js&\"\nimport style0 from \"./auth.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/auth/auth.vue\"\nexport default component.exports","export * from \"-!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./auth.vue?vue&type=template&id=7ea503f4&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./auth.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./auth.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t\t<button type=\"primary\" @getuserinfo=\"getUserInfo\" open-type=\"getUserInfo\">微信登录</button>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport login from '@/utils/login';\r\n\timport getUserInfo from '@/utils/getuserinfo';\r\n\timport request from '@/utils/request';\r\n\timport getSetting from '@/utils/getsetting';\r\n\r\n\texport default {\r\n\t\t// 将用户信息发送给服务端，由服务端\r\n\t\t// 对用户信息进行验证，如果通过响应\r\n\t\t// 一个 token ，前端获取这个 token \r\n\t\t// 将其记录在本地，以后再发请求时\r\n\t\t// 将这个 token 一并发送给服务端即可。\r\n\r\n\t\tmethods: {\r\n\t\t\tgetUserInfo(ev) {\r\n\t\t\t\t// 当出现授权窗口后，用户的操作（允许/拒绝）\r\n\t\t\t\t// 都会触发该回调\r\n\t\t\t\t// console.log(ev);\r\n\r\n\t\t\t\t// 解构出用户信息\r\n\t\t\t\tconst {\r\n\t\t\t\t\tencryptedData,\r\n\t\t\t\t\tiv,\r\n\t\t\t\t\trawData,\r\n\t\t\t\t\tsignature\r\n\t\t\t\t} = ev.target;\r\n\r\n\t\t\t\t// 发送请求，换取 token\r\n\t\t\t\tthis.auth(encryptedData, iv, rawData, signature);\r\n\t\t\t},\r\n\r\n\t\t\tasync auth(encryptedData, iv, rawData, signature) {\r\n\r\n\t\t\t\t// 1. 获取登录凭证\r\n\t\t\t\tconst {\r\n\t\t\t\t\tcode\r\n\t\t\t\t} = await login();\r\n\t\t\t\t// console.log(code);\r\n\r\n\t\t\t\t// 2. 发送请求\r\n\t\t\t\tconst info = await request({\r\n\t\t\t\t\turl: '/api/public/v1/users/wxlogin',\r\n\t\t\t\t\tmethod: 'post',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tcode,\r\n\t\t\t\t\t\tencryptedData,\r\n\t\t\t\t\t\tiv,\r\n\t\t\t\t\t\trawData,\r\n\t\t\t\t\t\tsignature\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\t// 记录 token\r\n\t\t\t\tif (info.meta.status == 200) {\r\n\t\t\t\t\tuni.setStorageSync('token', info.message.token);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 返回上一步操作\r\n\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\tdelta: 1\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// console.log(info);\r\n\r\n\t\t\t\t// 获取请求所需要的一些参数\r\n\t\t\t\t// 1. 获取 code 即登录凭证\r\n\t\t\t\t// uni.login({\r\n\t\t\t\t//   success: function (res) {\r\n\t\t\t\t//     console.log(res);\r\n\t\t\t\t//   }\r\n\t\t\t\t// })\r\n\r\n\t\t\t\t// 3. 发送请求\r\n\t\t\t\t// request({\r\n\t\t\t\t//   url: '/api/public/v1/users/wxlogin',\r\n\t\t\t\t//   data: {\r\n\t\t\t\t//     code,\r\n\t\t\t\t//     iv,\r\n\t\t\t\t//     ...\r\n\t\t\t\t//   },\r\n\r\n\t\t\t\t//   success: function (token) {\r\n\t\t\t\t//     uni.setStorageSync('token', token);\r\n\t\t\t\t//   }\r\n\t\t\t\t// })\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tasync onLoad() {\r\n\r\n\t\t\t// 如果用户已经授权了，主动的调用接口获取用户信息\r\n\t\t\tconst {\r\n\t\t\t\tauthSetting\r\n\t\t\t} = await getSetting();\r\n\r\n\t\t\tif (authSetting['scope.userInfo']) {\r\n\t\t\t\t// 用户的信息\r\n\t\t\t\tconst {\r\n\t\t\t\t\tencryptedData,\r\n\t\t\t\t\tiv,\r\n\t\t\t\t\trawData,\r\n\t\t\t\t\tsignature\r\n\t\t\t\t} = await getUserInfo();\r\n\r\n\t\t\t\t// 调用登录接口\r\n\t\t\t\tthis.auth(encryptedData, iv, rawData, signature);\r\n\t\t\t}\r\n\r\n\r\n\t\t\t// var _this = this;\r\n\r\n\t\t\t// 2. 获取用户信息，getUserInfo 如果用户在未授权的情况下\r\n\t\t\t// 无法获取用户的信息！！！\r\n\r\n\t\t\t// 必须由用户主动点击，打开授权窗口！！\r\n\t\t\t// wx.getUserInfo({\r\n\t\t\t//   success: function (info) {\r\n\t\t\t//     // console.log(info);\r\n\r\n\t\t\t//     const {encryptedData, iv, rawData, signature} = info;\r\n\t\t\t//     _this.auth(encryptedData, iv, rawData, signature);\r\n\t\t\t//   }\r\n\t\t\t// })\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n  button {\n    width: 600rpx;\n    margin: 200rpx auto 0; \n  }\r\n</style>\n","import mod from \"-!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./auth.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./auth.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1605691211922\n      var cssReload = require(\"D:/HBuilderX.2.9.3.20201014.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}